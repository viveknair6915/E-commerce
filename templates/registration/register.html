{% extends 'base.html' %}

{% block title %}Create an Account{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
        <div class="card shadow">
            <div class="card-body p-5">
                <h2 class="text-center mb-4">Create an Account</h2>
                
                <form method="post" id="register-form">
                    {% csrf_token %}
                    
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="id_first_name" class="form-label">First Name</label>
                            <input type="text" name="first_name" class="form-control" id="id_first_name" 
                                   value="{{ form.first_name.value|default:'' }}" required>
                            {% if form.first_name.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ form.first_name.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-6">
                            <label for="id_last_name" class="form-label">Last Name</label>
                            <input type="text" name="last_name" class="form-control" id="id_last_name" 
                                   value="{{ form.last_name.value|default:'' }}" required>
                            {% if form.last_name.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ form.last_name.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-12">
                            <label for="id_username" class="form-label">Username</label>
                            <input type="text" name="username" class="form-control" id="id_username" 
                                   value="{{ form.username.value|default:'' }}" required>
                            <div class="form-text">Required. 150 characters or fewer. Letters, digits and @/./+/-/_ only.</div>
                            {% if form.username.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ form.username.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-12">
                            <label for="id_email" class="form-label">Email</label>
                            <input type="email" name="email" class="form-control" id="id_email" 
                                   value="{{ form.email.value|default:'' }}" required>
                            {% if form.email.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ form.email.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-6">
                            <label for="id_password1" class="form-label">Password</label>
                            <div class="input-group">
                                <input type="password" name="password1" class="form-control" id="id_password1" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button" data-target="id_password1">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            {% if form.password1.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ form.password1.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-md-6">
                            <label for="id_password2" class="form-label">Confirm Password</label>
                            <div class="input-group">
                                <input type="password" name="password2" class="form-control" id="id_password2" required>
                                <button class="btn btn-outline-secondary toggle-password" type="button" data-target="id_password2">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            {% if form.password2.errors %}
                                <div class="invalid-feedback d-block">
                                    {{ form.password2.errors.0 }}
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="col-12">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="terms" required>
                                <label class="form-check-label" for="terms">
                                    I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">Terms of Service</a> and 
                                    <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">Privacy Policy</a>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-primary btn-lg">Create Account</button>
                    </div>
                </form>
                
                <hr class="my-4">
                
                <p class="text-center mb-0">
                    Already have an account? 
                    <a href="{% url 'login' %}">Sign in</a>
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Terms of Service Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Terms of Service</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h6>1. Account Terms</h6>
                <p>You are responsible for maintaining the security of your account and password. The Company cannot and will not be liable for any loss or damage from your failure to comply with this security obligation.</p>
                
                <h6>2. Payment and Renewal</h6>
                <p>By selecting a subscription plan, you agree to pay the Company the monthly or annual subscription fees indicated for that service.</p>
                
                <h6>3. Cancellation and Termination</h6>
                <p>You can cancel your account at any time by contacting us at support@example.com.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Privacy Policy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Privacy Policy</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h6>1. Information We Collect</h6>
                <p>We collect information you provide directly to us, such as when you create an account, subscribe to our newsletter, or contact us.</p>
                
                <h6>2. How We Use Your Information</h6>
                <p>We use the information we collect to provide, maintain, and improve our services, process transactions, and send you related information.</p>
                
                <h6>3. Information Sharing</h6>
                <p>We do not share your personal information with third parties except as described in this Privacy Policy.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Toggle password visibility
document.querySelectorAll('.toggle-password').forEach(button => {
    button.addEventListener('click', function() {
        const targetId = this.getAttribute('data-target');
        const passwordInput = document.getElementById(targetId);
        const icon = this.querySelector('i');
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    });
});

// Form validation
document.getElementById('register-form').addEventListener('submit', function(e) {
    const password1 = document.getElementById('id_password1').value;
    const password2 = document.getElementById('id_password2').value;
    const terms = document.getElementById('terms');
    
    if (password1 !== password2) {
        e.preventDefault();
        alert('Passwords do not match!');
        return false;
    }
    
    if (!terms.checked) {
        e.preventDefault();
        alert('You must agree to the Terms of Service and Privacy Policy.');
        return false;
    }
    
    return true;
});
</script>
{% endblock %}
